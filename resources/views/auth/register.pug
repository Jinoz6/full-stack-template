
extends layout

block content
    #register
    main.main-content.mt-0.ps
      .page-header.align-items-start.min-vh-100
        .container.my-auto
          .row
            .col-lg-4.col-md-8.col-12.mx-auto
              .card.card-plain
                .card-header
                  h4.font-weight-bolder.text-center Sign Up
                  p.mb-0.text-center Enter your email and password to register
                .card-body
                  form(role='form' onsubmit="register();return false")
                    .input-group.input-group-outline.mb-3
                      //- label.form-label Email
                      input.form-control(type='email' placeholder="Email" id="email" required)
                    .input-group.input-group-outline.mb-3
                      //- label.form-label Password
                      input.form-control(type='password' placeholder="Password" id="password" required)
                    .text-center
                      button.btn.bg-gradient-primary.shadow.w-100.mt-4.mb-0(type='submit') Sign Up
                .card-footer.text-center.pt-0.px-lg-2.px-1
                  p.mb-2.text-sm.mx-auto
                    | Already have an account?
                    a.text-primary.text-gradient.font-weight-bold(href='login')  Sign in

        script(src="/javascripts/components/auth/register.js")
        script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous")
        script.
          function register(){

            let email = document.querySelector('#email').value
            let pass = document.querySelector('#password').value

            fetch('http://localhost:8000/api/register', {
              method: 'POST', // or 'PUT'
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                email:email,
                pass:pass
              }),
            })
              .then((response) => response.json())
              .then((data) => {
                console.log('Success:', data);

                if(data.status == 200){
                  setTimeOut(()=>{
                     window.location.href = "/login"
                  },5000)
                
                }

              })
              .catch((error) => {
                console.error('Error:', error);
              });

          }